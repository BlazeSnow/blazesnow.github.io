{"version":3,"file":"docsify-copy-code.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/index.js"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import './styles.css';\n\nfunction docsifyCopyCode(hook, vm) {\n  const i18n = {\n    buttonText: 'Copy to clipboard',\n    errorText: 'Error',\n    successText: 'Copied',\n  };\n\n  hook.doneEach(function () {\n    const targetElms = Array.from(document.querySelectorAll('pre[data-lang]'));\n\n    // Update i18n strings based on options and location.href\n    if (vm.config.copyCode) {\n      Object.keys(i18n).forEach((key) => {\n        const textValue = vm.config.copyCode[key];\n\n        if (typeof textValue === 'string') {\n          i18n[key] = textValue;\n        } else if (typeof textValue === 'object') {\n          Object.keys(textValue).some((match) => {\n            const isMatch = location.href.indexOf(match) > -1;\n\n            i18n[key] = isMatch ? textValue[match] : i18n[key];\n\n            return isMatch;\n          });\n        }\n      });\n    }\n\n    const template = [\n      '<button class=\"docsify-copy-code-button\">',\n      `<span class=\"label\">${i18n.buttonText}</span>`,\n      `<span class=\"error\" aria-hidden=\"hidden\">${i18n.errorText}</span>`,\n      `<span class=\"success\" aria-hidden=\"hidden\">${i18n.successText}</span>`,\n      '<span aria-live=\"polite\"></span>',\n      '</button>',\n    ].join('');\n\n    targetElms.forEach((elm) => {\n      elm.insertAdjacentHTML('beforeend', template);\n    });\n  });\n\n  hook.mounted(function () {\n    const listenerHost = document.querySelector('.content');\n\n    if (listenerHost) {\n      listenerHost.addEventListener('click', function (evt) {\n        const isCopyCodeButton = evt.target.classList.contains(\n          'docsify-copy-code-button'\n        );\n\n        if (isCopyCodeButton) {\n          const buttonElm =\n            evt.target.tagName === 'BUTTON'\n              ? evt.target\n              : evt.target.parentNode;\n          const range = document.createRange();\n          const preElm = buttonElm.parentNode;\n          const codeElm = preElm.querySelector('code');\n          const liveRegionElm = buttonElm.querySelector('[aria-live]');\n\n          let selection = window.getSelection();\n\n          range.selectNode(codeElm);\n\n          if (selection) {\n            selection.removeAllRanges();\n            selection.addRange(range);\n          }\n\n          try {\n            // Copy selected text\n            const successful = document.execCommand('copy');\n\n            if (successful) {\n              buttonElm.classList.add('success');\n              liveRegionElm.innerText = i18n.successText;\n\n              setTimeout(function () {\n                buttonElm.classList.remove('success');\n                liveRegionElm.innerText = '';\n              }, 1000);\n            }\n          } catch (err) {\n            // eslint-disable-next-line no-console\n            console.error(`docsify-copy-code: ${err}`);\n\n            buttonElm.classList.add('error');\n            liveRegionElm.innerText = i18n.errorText;\n\n            setTimeout(function () {\n              buttonElm.classList.remove('error');\n              liveRegionElm.innerText = '';\n            }, 1000);\n          }\n\n          selection = window.getSelection();\n\n          if (selection) {\n            if (typeof selection.removeRange === 'function') {\n              selection.removeRange(range);\n            } else if (typeof selection.removeAllRanges === 'function') {\n              selection.removeAllRanges();\n            }\n          }\n        }\n      });\n    }\n  });\n}\n\n// Deprecation warning for v1.x: stylesheet\nif (document.querySelector('link[href*=\"docsify-copy-code\"]')) {\n  // eslint-disable-next-line no-console\n  console.warn(\n    '[Deprecation] Link to external docsify-copy-code stylesheet is no longer necessary.'\n  );\n}\n\n// Deprecation warning for v1.x: init()\nwindow.DocsifyCopyCodePlugin = {\n  init: function () {\n    return function (hook, vm) {\n      hook.ready(function () {\n        // eslint-disable-next-line no-console\n        console.warn(\n          '[Deprecation] Manually initializing docsify-copy-code using window.DocsifyCopyCodePlugin.init() is no longer necessary.'\n        );\n      });\n    };\n  },\n};\n\nwindow.$docsify = window.$docsify || {};\nwindow.$docsify.plugins = [docsifyCopyCode].concat(\n  window.$docsify.plugins || []\n);\n"],"names":["styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","docsifyCopyCode","hook","vm","i18n","buttonText","errorText","successText","doneEach","targetElms","Array","from","querySelectorAll","config","copyCode","Object","keys","forEach","key","textValue","_typeof","some","match","isMatch","location","href","indexOf","template","concat","join","elm","insertAdjacentHTML","mounted","listenerHost","querySelector","addEventListener","evt","isCopyCodeButton","target","classList","contains","buttonElm","tagName","parentNode","range","createRange","preElm","codeElm","liveRegionElm","selection","window","getSelection","selectNode","removeAllRanges","addRange","successful","execCommand","add","innerText","setTimeout","remove","err","console","error","removeRange","warn","DocsifyCopyCodePlugin","init","ready","$docsify","plugins"],"mappings":"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","x_google_ignoreList":[0]}